name: deploy-branch-backend

on:
  workflow_dispatch:

concurrency: deploy-branch-backend

jobs:
  deploy-branch-backend:
    uses: ./.github/workflows/deploy.yml
    with:
      TEST_BRANCH_BACKEND: 1
      LOAD_FIXTURES: 1
      DEPLOY_USER: branch
      DEPLOY_HOST: branch.mitmh2024.secretfakewebsite.com
      DEPLOY_TYPE: branch.backend
      BUILD_SITE: hunt-reg
      SERVER_ENVIRONMENT: test_branch
      BRANCH_BACKEND_HOSTNAME: branch.mitmh2024.secretfakewebsite.com
      HUNT_HOST: branch.mitmh2024.secretfakewebsite.com
      REGISTRATION_HOST: branch.mitmh2024.secretfakewebsite.com:8083
      COPY_GCS_CREDS: 1
      EXTRA_ENV: |-
        # serve HTTP on 172.17.0.1:28080
        SERVER_HTTP_BIND_PREFIX=172.17.0.1:28
        GOOGLE_ANALYTICS_ID=FIXME
    secrets: inherit
